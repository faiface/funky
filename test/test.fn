record Person = name : String, age : Int

func list->string : (a -> String) -> List a -> String =
    \string \list
    if (empty? list)
        "";
    if (empty? (rest list))
        (string (first list));
    string (first list) ++ ", " ++ list->string string (rest list)

func string : Bool -> String =
    \bool
    switch bool
    case true  "true"
    case false "false"

func range : Int -> Int -> List Int =
    \from \to
    if (from > to)
        [];
    from :: range (from + 1) to

func main : IO =
    100 |> 1 |> fix \loop \low \high
        let ((low + high) / 2) \mid
        print ("Is your number " ++ string mid ++ "? ");
        scanln \answer
        if (answer == "less")
            (loop low (mid - 1));
        if (answer == "more")
            (loop (mid + 1) high);
        if (answer == "yes")
            (println "Yay!"; done);
        println "You need to type one of less/more/yes.";
        loop low high
